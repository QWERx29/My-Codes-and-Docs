## 第七章 分治算法

##### *Problem#1* 找数              

###### 【题目描述】

给一个长度为n的单调递增的正整数序列，即序列中每一个数都比前一个数大。 有m个询问，每次询问一个x，问序列中最后一个小于等于x的数是什么？

###### 【输入格式】

第一行两个整数n，m。 接下来一行n个数，表示这个序列。 接下来m行每行一个数，表示一个询问。

###### 【输出格式】

输出共m行，表示序列中最后一个小于等于x的数是什么。 假如没有，则输出-1.

###### 【样例】

```
**样例输入**
5 3
1 2 3 4 6
5
1
3
**样例输出**
4
1
3
```

##### *Problem#2* 大规模排序（分治排序模板）



##### *Problem#3* 一元三次方程求解              

###### 【题目描述】

有形如：ax^3+bx^2+cx+d＝0这样的一个一元三次方程。给出该方程中各项的系数（a,b,c,d均为实数），并约定该方程存在三个不同实根（根的范围在-100至100之间），且根与根之差的绝对值≥1。 要求由小到大依次在同一行输出这三个实根（根与根之间留有空格），并精确到小数点后2位。 提示：记方程f（x）=0，若存在2个数x1和x2，且x1 < x2，f（x1）*f（x2）＜0，则在（x1，x2）之间一定有一个根。

###### 【输入格式】

a，b，c，d

###### 【输出格式】

三个实根（根与根之间留有空格）

###### 【样例】

```
**样例输入**
1 -5 -4 20
**样例输出**
-2.00 2.00 5.00
```

##### *Problem#4* 快速幂取模              

###### 【题目描述】

给出三个整数a,b,m，求a^b mod m的值。

###### 【输入格式】

一行三个整数a,b,m  。

###### 【输出格式】

一个整数，表示a^b mod m的值。

###### 【样例】

```
**样例输入**
2 100 1007
**样例输出**
169
```

###### 【数据范围与提示】

对于全部数据，1<=a,b,m<=10^9。

##### *Problem#5* 循环比赛日程表              

###### 【题目描述】

设有N个选手进行循环比赛，其中N=2^M，要求每名选手要与其他N-1名选手都赛一次，每名选手每天比赛一次，循环赛共进行N-1天，要求每天没有选手轮空。

###### 【输入格式】

M

###### 【输出格式】

表格形式的比赛安排表 ，输出每个数据占3列，右对齐。

###### 【样例】

```
**样例输入**
3
**样例输出**
1  2  3  4  5  6  7  8
2  1  4  3  6  5  8  7
3  4  1  2  7  8  5  6
4  3  2  1  8  7  6  5
5  6  7  8  1  2  3  4
6  5  8  7  2  1  4  3
7  8  5  6  3  4  1  2
8  7  6  5  4  3  2  1
```

##### *Problem#6* 整数区间              

###### 【题目描述】

由于最近玉米高中的操场翻修了

所以有很多学生在操场上走步

由于YSJB后宫千万可是她仍然不满足

她试图在操场上拆散一对情侣并将其加入后宫

众所周知，玉米学校任何两个人之间都可能是情侣

所以YSJB决定找两个离得最近的人当做情侣，然后根据他们两个之间的距离来决定如何处理他们

你需要做的就是帮助YSJB找到离得最近的两个人之间的距离

###### 一句话题意:

给定平面上n个点，找出其中的一对点的距离，使得在这n个点的所有点对中，该距离为所有点对中最小的

###### 【输入格式】

第一行：n；2≤n≤200000

接下来n行：每行两个实数：x y，表示一个点的行坐标和列坐标，中间用一个空格隔开。

###### 【输出格式】

仅一行，一个实数，表示最短距离，精确到小数点后面4位。

###### 【样例】

```
**样例输入**
3
1 1
1 2
2 2
**样例输出**
1.0000
```

###### 【数据范围与提示】

2<n<=200000

-10^9<x,y<10^9

##### *Problem#7* 最大整数                                      

###### 【题目描述】

【背景】 在双人对决的竞技性比赛，如乒乓球、羽毛球、国际象棋中，最常见的赛制是淘汰赛和循环赛。前者的特点是比赛场数少，每场都紧张刺激，但偶然性较高。后者的特点是较为公平，偶然性较低，但比赛过程往往十分冗长。 本题中介绍的瑞士轮赛制，因最早使用于1895年在瑞士举办的国际象棋比赛而得名。它可以看作是淘汰赛与循环赛的折衷，既保证了比赛的稳定性，又能使赛程不至于过长。

【问题描述】 2*N名编号为1~2N的选手共进行R轮比赛。每轮比赛开始前，以及所有比赛结束后，都会对选手进行一次排名。排名的依据是选手的总分。选手的总分为第一轮开始前的初始分数加上已参加过的所有比赛的得分和。总分相同的，约定编号较小的选手排名靠前。 每轮比赛的对阵安排与该轮比赛开始前的排名有关：第1名和第2名、第3名和第4名、……、第2K – 1名和第2K名、…… 、第2N –  1名和第2N名，各进行一场比赛。每场比赛胜者得1分，负者得0分。也就是说除了首轮以外，其它轮比赛的安排均不能事先确定，而是要取决于选手在之前比赛中的表现。 现给定每个选手的初始分数及其实力值，试计算在R轮比赛过后，排名第Q的选手编号是多少。我们假设选手的实力值两两不同，且每场比赛中实力值较高的总能获胜。

###### 【输入格式】

输入的第一行是三个正整数N、R、Q，每两个数之间用一个空格隔开，表示有2\*N名选手、R轮比赛，以及我们关心的名次Q。 第二行是2\*N个非负整数s1, s2, …, s2N，每两个数之间用一个空格隔开，其中si表示编号为i的选手的初始分数。 第三行是2*N个正整数w1, w2, …, w2N，每两个数之间用一个空格隔开，其中wi表示编号为i的选手的实力值。

###### 【输出格式】

输出只有一行，包含一个整数，即R轮比赛结束后，排名第Q的选手的编号。

###### 【样例】

```
**样例输入**
3
13  312  343
**样例输出**
34331213
**样例说明**
本轮对阵 本轮结束后的得分 
选手编号 / ① ② ③ ④ 
初始 / 7 6 6 7 
第1轮 ①—④ ②—③ 7 6 7 8 
第2轮 ④—① ③—② 7 6 8 9 
第3轮 ④—③ ①—② 8 6 9 9 
第4轮 ③—④ ①—② 9 6 10 9 
```

###### 【数据范围与提示】

```
对于30%的数据，1 < = N < = 100； 
对于50%的数据，1 < = N < = 10,000； 
对于100%的数据，1 < = N < = 100,000，1 < = R < = 50，1 < = Q < = 2N，0 < = s1, s2, …, s2N 10^8，1 < = w1, w2, …, w2N 10^8。
```

##### *Problem#8* 转圈游戏

###### 【题目描述】

  n个小伙伴（编号从0到n-1）围坐一圈玩游戏。按照顺时针方向给n个位置编号，从n到n-1 。最初，第0号小伙伴在第0号位置，第1号小伙伴在第 1 号位置，……，依此类推。

游戏规则如下：每一轮第0号位置上的小伙伴顺时针走到第m 号位置，第 1号位置小伙伴走到第m+1号位置，……，依此类推，第n-m号位置上的小伙伴走到第0 号位置，第n-m+1号位置上的小伙伴走到第1号位置，……，第n-1号位置上的小伙伴顺时针走到第 m-1号位置。

现在，一共进行了10^k轮，请问x号小伙伴最后走到了第几号位置。

###### 【输入格式】

输入共1行，包含2个整数n 、m、k 、x，每两个整数之间用一个空格隔开。

###### 【输出格式】

输出共 1行，包含1个整数，表示10^k 轮后x号小伙伴所在的位置编号。

###### 【样例】

```
**样例输入**
10 3 4 5
**样例输出**
5
```

###### 【数据范围与提示】

对于 30% 的数据,0<k<7；

对于 80% 的数据,0<k<10^7；

对于 100% 的数据，1<n<10^6，0<m<n，1<=x<=n，0<k<10^9  。

##### *Problem#9* 火柴排队   

###### 【题目描述】

涵涵有两盒火柴，每盒装有       根火柴，每根火柴都有一个高度。现在将每盒中的火柴各自排成一列，同一列火柴的高度互不相同，两列火柴之间的距离定义为
$$
\sum_{i=1}^n(a_i-b_i)^2
$$
其中ai表示第一列火柴中第i个火柴的高度，bi表示第二列火柴中i个火柴的高度。

每列火柴中相邻两根火柴的位置都可以交换，请你通过交换使得两列火柴之间的距离最小。请问得到这个最小的距离，最少需要交换多少次？**如果这个数字太大，请输出这个最小交换次数对 99,999,997 取模的结果。**

###### 【输入格式】

共三行，第一行包含一个整数n，表示每盒中火柴的数目。

第二行有n个整数，每两个整数之间用一个空格隔开，表示第一列火柴的高度。

第三行有n个整数，每两个整数之间用一个空格隔开，表示第二列火柴的高度。

###### 【输出格式】

输出共一行，包含一个整数，表示最少交换次数对 99,999,997 取模的结果。

###### 【样例】

```
**样例输入1**
4
2 3 1 4
3 2 1 4
**样例输出1**
1
**样例说明1**
最小距离是0，最少需要交换1次，比如：交换第1列的前2根火柴或者交换第2列的前2根火柴。
**样例输入2**
4
1 3 4 2
1 7 2 4
**样例输出2**
2
**样例说明2**
最小距离是 ，最少需要交换 次，比如：交换第 列的中间 根火柴的位置，再交换第 列中后 根火柴的位置。
```

###### 【数据范围与提示】

对于 10% 的数据1<=n<=10；

对于 30% 的数据，1<=n<=100；

对于 60% 的数据，1<=n<=5000；

对于 100% 的数据，1<=n<=100 000，0<=火柴高度<=2^31-1  。

##### *Problem#10* 跳石头

###### 【题目描述】

一年一度的“跳石头”比赛又要开始了！

这项比赛将在一条笔直的河道中进行，河道中分布着一些巨大岩石。组委会已经选择好了两块岩石作为比赛起点和终点。在起点和终点之间，有N块岩石（不含起点和终点的岩石）。在比赛过程中，选手们将从起点出发，每一步跳向相邻的岩石，直至到达终点。

为了提高比赛难度，组委会计划移走一些岩石，使得选手们在比赛过程中的最短跳跃距离尽可能长。由于预算限制，组委会至多从起点和终点之间移走M块岩石（不能移走起点和终点的岩石）。

###### 【输入格式】

输入文件第一行包含三个整数L,N,M，分别表示起点到终点的距离，起点和终点之间的岩石数，以及组委会至多移走的岩石数。

接下来 N行，每行一个整数，第i行的整数Di（0<Di<L ）表示第i块岩石与起点的距离。这些岩石按与起点距离从小到大的顺序给出，且不会有两个岩石出现在同 一个位置。

###### 【输出格式】

输出文件只包含一个整数，即最短跳跃距离的最大值。

###### 【样例】

```
**样例输入**
25 5 2 
2
11
14
17 
21
**样例输出**
4
```

###### 【数据范围与提示】

对于20%的数据，0<=M<=N<=10  。
 对于50 的数据，0<=M<=N<=100 。
 对于100% 的数据，0<=m<=n<=50 000  ，1<=L<=1,000,000,000 。

##### *Problem#11* 统计数字

###### 【题目描述】

某次科研调查时得到了n个自然数，每个数均不超过1500000000（1.5*10^9）。已知不相同的数不超过10000个，现在需要统计这些自然数各自出现的次数，并按照自然数从小到大的顺序输出统计结果。


###### 【输入格式】

输入文件count.in包含n+1行： 第1行是整数n，表示自然数的个数。 第2~n+1行每行一个自然数。

###### 【输出格式】

输出文件count.out包含m行（m为n个自然数中不相同数的个数），按照自然数从小到大的顺序输出。每行输出两个整数，分别是自然数和该数出现的次数，其间用一个空格隔开。

###### 【样例】

```
**样例输入**
8
2
4
2
4
5
100
2
100
**样例输出**
2 3
4 2
5 1
100 2
```

###### 【数据范围与提示】

40%的数据满足：1<=n<=1000 

80%的数据满足：1<=n<=50000 

100%的数据满足：1<=n<=200000，每个数均不超过1 500 000 000（1.5*10^9）

##### *Problem#12* 愤怒的牛

###### 【题目描述】

**原题来自：USACO 2005 Feb. Gold**

农夫约翰建造了一座有n间牛舍的小屋，牛舍排在一条直线上，第i间牛舍在xi的位置，但是约翰的m头牛对小屋很不满意，因此经常互相攻击。约翰为了防止牛之间互相伤害，因此决定把每头牛都放在离其它牛尽可能远的牛舍。也就是要最大化最近的两头牛之间的距离。

牛们并不喜欢这种布局，而且几头牛放在一个隔间里，它们就要发生争斗。为了不让牛互相伤害。John 决定自己给牛分配隔间，使任意两头牛之间的最小距离尽可能的大，那么，这个最大的最小距离是多少呢？

###### 【输入格式】

第一行用空格分隔的两个整数n和m；

第二行为n个用空格隔开的整数，表示位置xi 。

###### 【输出格式】

输出仅一个整数，表示最大的最小距离值。

###### 【样例】

```
**样例输入**
5 3
1 2 8 4 9
**样例输出**
3
**样例说明**
```

###### 【数据范围与提示】

2<=n<=10^5,0<=xi<=10^9,2<=m<=n.

##### *Problem#13* Best Cow Fences              

###### 【题目描述】

**原题来自：USACO 2003 Mar. Green**

给定一个长度为n的非负整数序列A ，求一个平均数最大的，长度不小于L的子段。

###### 【输入格式】

第一行用空格分隔的两个整数n 和L；

第二行为n个用空格隔开的非负整数，表示Ai。

###### 【输出格式】

输出一个整数，表示答案的1000倍。不用四舍五入，直接输出。

###### 【样例】

```
**样例输入**
10 6
6 4 2 10 3 8 5 9 4 1 
**样例输出**
6500
```

###### 【数据范围与提示】

1<=n<=10^5,0<=Ai<=2000。
