## 第二章 数据排序   

##### *Problem#1* 小规模排序

##### *Problem#2* 车厢重组

###### 【题目描述】

在一个旧式的火车站旁边有一座桥，其桥面可以绕河中心的桥墩水平旋转。一个车站的职工发现桥的长度最多能容纳两节车厢，如果将桥旋转180度，则可以把相邻两节车厢的位置交换，用这种方法可以重新排列车厢的顺序。于是他就负责用这座桥将进站的车厢按车厢号从小到大排列。他退休后，火车站决定将这一工作自动化，其中一项重要的工作是编一个程序，输入初始的车厢顺序，计算最少用多少步就能将车厢排序。

###### 【输入格式】

输入文件有两行数据，第一行是车厢总数N（不大于10000），第二行是N个不同的数表示初始的车厢顺序。

###### 【输出格式】

一个数据，是最少的旋转次数。

###### 【样例】

```
**样例输入**
4
4 3 2 1 
**样例输出**
6
```

##### *Problem#3* 明明的随机数

###### 【题目描述】

明明想在学校中请一些同学一起做一项问卷调查，为了实验的客观性，他先用计算机生成了N个1到1000之间的随机整数（N≤100），对于其中重复的数字，只保留一个，把其余相同的数去掉，不同的数对应着不同的学生的学号。然后再把这些数从小到大排序，按照排好的顺序去找同学做调查。请你协助明明完成“去重”与“排序”的工作。

###### 【输入格式】

输入文件 有2行，第1行为1个正整数，表示所生成的随机数的个数： N 第2行有N个用空格隔开的正整数，为所产生的随机数。

###### 【输出格式】

输出文件也是2行，第1行为1个正整数M，表示不相同的随机数的个数。第2行为M个用空格隔开的正整数，为从小到大排好序的不相同的随机数。

###### 【样例】

```
**样例输入**
10
20 40 32 67 40 20 89 300 400 15
**样例输出**
8
15 20 32 40 67 89 300 400
```

##### *Problem#4* 大规模排序

##### *Problem#5* 光荣的梦想              

###### 【题目描述】

Prince对他在这片大陆上维护的秩序感到满意，于是决定启程离开艾泽拉斯。在他动身之前，Prince决定赋予King_Bette最强大的能量以守护世界、保卫这里的平衡与和谐。在那个时代，平衡是个梦想。因为有很多奇异的物种拥有各种不稳定的能量，平衡瞬间即被打破。KB决定求助于你，帮助他完成这个梦想。 一串数列即表示一个世界的状态。 平衡是指这串数列以升序排列。而从一串无序数列到有序数列需要通过交换数列中的元素来实现。KB的能量只能交换相邻两个数字。他想知道他最少需要交换几次就能使数列有序。

###### 【输入格式】

第一行为数列中数的个数n,第二行为n < = 10000个数。表示当前数列的状态。

###### 【输出格式】

输出一个整数，表示最少需要交换几次能达到平衡状态。

###### 【样例】

```
**样例输入**
4
2 1 4 3
**样例输出**
2
```

##### *Problem#6* 奖学金                            

###### 【题目描述】

某小学最近得到了一笔赞助，打算拿出其中一部分为学习成绩优秀的前5名学生发奖学金。期末，每个学生都有3门课的成绩：语文、数学、英语。先按总分从高到低排序，如果两个同学总分相同，再按语文成绩从高到低排序，如果两个同学总分和语文成绩都相同，那么规定学号小的同学排在前面，这样，每个学生的排序是唯一确定的。 任务：先根据输入的3门课的成绩计算总分，然后按上述规则排序，最后按排名顺序输出前5名学生的学号和总分。注意，在前5名同学中，每个人的奖学金都不相同，因此，你必须严格按上述规则排序。例如，在某个正确答案中，如果前两行的输出数据（每行输出两个数：学号、总分）是： 7 279 5 279 这两行数据的含义是：总分最高的两个同学的学号依次是7号、5号。这两名同学的总分都是279（总分等于输入的语文、数学、英语三科成绩之和），但学号为7的学生语文成绩更高一些。如果你的前两名的输出数据是： 5 279 7 279 则按输出错误处理，不能得分。

###### 【输入格式】

输入文件scholar.in包含n+1行： 第1行为一个正整数n，表示该校参加评选的学生人数。 第2到n+1行，每行有3个用空格隔开的数字，每个数字都在0到100之间。第j行的3个数字依次表示学号为j-1的学生的语文、数学、英语的成绩。每个学生的学号按照输入顺序编号为1~n（恰好是输入数据的行号减1）。 所给的数据都是正确的，不必检验。

###### 【输出格式】

输出文件scholar.out共有5行，每行是两个用空格隔开的正整数, 依次表示前5名学生的学号和总分。

###### 【样例】

```
**样例输入1**
6
90 67 80
87 66 91
78 89 91
88 99 77
67 89 64
78 89 98
**样例输出1**
6 265
4 264
3 258
2 244
1 237
**样例输入2**
8 
80 89 89 
88 98 78 
90 67 80 
87 66 91 
78 89 91 
88 99 77 
67 89 64 
78 89 98 
**样例输出2**
8 265 
2 264 
6 264 
1 258 
5 258 
```

###### 【数据范围与提示】

50%的数据满足：各学生的总成绩各不相同 

100%的数据满足：6<=n<=300

##### *Problem#7* 统计数字              

###### 【题目描述】

某次科研调查时得到了n个自然数，每个数均不超过1500000000（1.5*10^9）。已知不相同的数不超过10000个，现在需要统计这些自然数各自出现的次数，并按照自然数从小到大的顺序输出统计结果。

###### 【输入格式】

输入文件count.in包含n+1行： 第1行是整数n，表示自然数的个数。 第2~n+1行每行一个自然数。

###### 【输出格式】

输出文件count.out包含m行（m为n个自然数中不相同数的个数），按照自然数从小到大的顺序输出。每行输出两个整数，分别是自然数和该数出现的次数，其间用一个空格隔开。

###### 【样例】

```
**样例输入**
8
2
4
2
4
5
100
2
100
**样例输出**
2 3
4 2
5 1
100 2
```

###### 【数据范围与提示】

40%的数据满足：1<=n<=1000 

80%的数据满足：1<=n<=50000 

100%的数据满足：1<=n<=200000，每个数均不超过1 500 000 000（1.5*10^9）

##### *Problem#8* 分数线划定              

###### 【题目描述】

世博会志愿者的选拔工作正在A 市如火如荼的进行。为了选拔最合适的人才，A  市对所有报名的选手进行了笔试，笔试分数达到面试分数线的选手方可进入面试。面试分数线根据计划录取人数的150%划定，即如果计划录取m名志愿者，则面试分数线为排名第m*150% （向下取整）名的选手的分数，而最终进入面试的选手为笔试成绩不低于面试分数线的所有 选手。 现在就请你编写程序划定面试分数线，并输出所有进入面试的选手的报名号和笔试成绩。

###### 【输入格式】

第一行，两个整数n，m（5 ≤ n ≤ 5000，3 ≤ m ≤ n），中间用一个空格隔开，其中n 表示报名参加笔试的选手总数，m 表示计划录取的志愿者人数。输入数据保证m*150% 向下取整后小于等于n。 第二行到第n+1 行，每行包括两个整数，中间用一个空格隔开，分别是选手的报名号k（1000 ≤ k ≤ 9999）和该选手的笔试成绩s（1 ≤ s ≤ 100）。数据保证选手的报名号各不相同。

###### 【输出格式】

第一行，有两个整数，用一个空格隔开，第一个整数表示面试分数线；第二个整数为进入面试的选手的实际人数。 从第二行开始，每行包含两个整数，中间用一个空格隔开，分别表示进入面试的选手的报名号和笔试成绩，按照笔试成绩从高到低输出，如果成绩相同，则按报名号由小到大的顺序输出。

###### 【样例】

```
**样例输入**
6 3
1000 90
3239 88
2390 95
7231 84
1005 95
1001 88
**样例输出**
88 5
1005 95
2390 95
1000 90
1001 88
3239 88
**样例说明**
m*150% = 3*150% = 4.5，向下取整后为4。保证4 个人进入面试的分数线为88，但因为88 有重分，所以所有成绩大于等于88 的选手都可以进入面试，故最终有5 个人进入面试。
```

##### *Problem#9* 大规模逆序对问题              

###### 【题目描述】

给出一个数列$a_1,a_2,...,a_n$，求其中逆序对的个数。

###### 【输入格式】

第一行为一个整数$n(1\le n\le 200000)$； 第二行为$n$ 个整数$a_1,a_2,...,a_n$ 。

###### 【输出格式】

仅一个整数，为逆序对的总个数。

###### 【样例】

```
**样例输入**
5
1 3 4 2 5
**样例输出**
2
```

###### 【数据范围与提示】

$1\le a_i \le 2*10^5$

##### *Problem#10* 书架

###### 【题目描述】

Farmer John最近为奶牛图书馆购买了一个书架，书架的下层很快装满了书，现在只剩下了顶层书架有空间。 在 N (1 ≤ N ≤ 20,000)头牛中，第i头牛的身高为 Hi (1 ≤ Hi ≤ 10,000)。书架的高度为 B (1 ≤ B ≤ 2,000,000,007)，且 B 小于所有奶牛的身高之和。 书架的顶层高于最高的牛的身高，但是若干个奶牛可以站成一摞，这样总高度就是它们的身高之和。总高度应大于等于书架的高度，奶牛才能取到书。 但是越多的奶牛站成一摞，它们就越危险。你的工作就是找到一个集合，使得尽量少的奶牛站成一摞，当然，它们要能取到顶层的书。

###### 【输入格式】

第 1 行: 两个整数: N , B • 第 2..N+1 行: 第 i+1 行包含一个整数 Hi

###### 【输出格式】

第 1 行: 一个整数，这个使得尽量少的奶牛站成一摞取得顶层的书的集合中奶牛的个数。

###### 【样例】

```
**样例输入**
6 40
6
18
11
13
19
11
**样例输出**
3
```

##### *Problem#12* 奶牛的选举

###### 【题目描述】

[Jeffrey Wang, 2007] 在推翻了Farmer John这个残暴的统治者后，奶牛们举行了她们的第一次总统大选，贝茜也是N(1 <= N <=  50,000)头候选奶牛之一。不过，作为一头有远见的奶牛，贝茜想在选举开始前就计算出，哪头奶牛最有可能在竞争中胜出。 选举分两轮进行。第一轮中，得票最多的K(1 <= K <= N)头奶牛晋级到下一轮，在第二轮选举中得票最多的奶牛成为最终的总统。 现在，贝茜告诉了你奶牛i在第一轮投票中的期望得票数A_i(1 <= A_i <=  1,000,000,000)以及她在第二轮投票中的期望得票数B_i(1 <= B_i <=  1,000,000,000)（如果奶牛i能成功晋级的话），她希望你帮她计算一下，如果这些数据无误，那么哪头奶牛将成为总统。任何数值都不会在A_i列表中出现两次，在B_i列表中也是如此。

###### 【输入格式】

第1行: 2个用空格隔开的整数：N 和 K • 第2..N+1行: 第i+1为2个用空格隔开的整数：A_i 和 B_i

###### 【输出格式】

第1行: 输出1个整数，为将被选为总统的奶牛的编号

###### 【样例】

```
**样例输入**
5 3
3 10
9 2
5 6
8 4
6 5
**样例输出**
5
**样例说明**
一共有5头奶牛参加选举，在第一轮中得票最多的3头奶牛可以晋级至第二轮。奶牛们在第一轮中的得票期望分别为3，9，5，8，6，第二轮中，分别为10，2，6，4，5。
奶牛2，4，5晋级到第二轮。奶牛5在第二轮投票中得到了最多的5票，赢得了选举的最终胜利。
```

###### 
